function z = my_obj_fun_CAISO_vector_scaled_overnight(x)   %x is an nx1 vector of weights
%rho is the CAISO correlation matrix derived from first stages of model
%in this function it is the correlation matrix derived by V * C * V^T
% x will be a row vector of size specified in main function call 
Rho = [1.00	0.58	0.42	0.41	0.16	0.24	0.33	0.37	0.36	0.24	0.39	0.46	0.46	0.51	0.41	0.42	0.31	0.31;...
0.58	1.00	0.44	0.42	0.16	0.25	0.33	0.38	0.37	0.25	0.40	0.47	0.47	0.52	0.42	0.43	0.32	0.32;...
0.42	0.44	1.00	0.33	0.08	0.17	0.14	0.31	0.31	0.20	0.34	0.37	0.37	0.41	0.35	0.35	0.25	0.25;...
0.41	0.42	0.35	1.00	0.12	0.20	0.26	0.30	0.29	0.22	0.38	0.39	0.39	0.41	0.38	0.38	0.24	0.25;...
0.16	0.16	0.08	0.12	1.00	0.30	0.20	0.03	0.03	0.07	0.11	0.13	0.13	0.15	0.12	0.12	0.02	0.03;...
0.24	0.25	0.17	0.20	0.30	1.00	0.20	0.14	0.13	0.12	0.19	0.21	0.21	0.24	0.20	0.20	0.09	0.10;...
0.33	0.33	0.14	0.26	0.20	0.20	1.00	0.09	0.08	0.16	0.25	0.28	0.28	0.20	0.26	0.26	0.08	0.07;...
0.37	0.38	0.31	0.30	0.03	0.14	0.09	1.00	0.32	0.17	0.29	0.32	0.32	0.36	0.30	0.30	0.25	0.25;...
0.36	0.37	0.31	0.29	0.03	0.13	0.08	0.32	1.00	0.17	0.29	0.32	0.32	0.36	0.29	0.30	0.24	0.25;...
0.24	0.25	0.20	0.22	0.07	0.12	0.16	0.17	0.17	1.00	0.22	0.23	0.23	0.24	0.22	0.22	0.14	0.15;...
0.39	0.40	0.34	0.38	0.11	0.19	0.25	0.29	0.29	0.22	1.00	0.49	0.49	0.39	0.38	0.38	0.23	0.24;...
0.46	0.47	0.37	0.39	0.13	0.21	0.28	0.32	0.32	0.23	0.49	1.00	0.50	0.44	0.39	0.40	0.26	0.27;...
0.46	0.47	0.37	0.39	0.13	0.21	0.28	0.32	0.32	0.23	0.49	0.50	1.00	0.44	0.39	0.39	0.26	0.27;...
0.51	0.52	0.41	0.41	0.15	0.24	0.20	0.36	0.36	0.24	0.39	0.44	0.44	1.00	0.41	0.41	0.30	0.31;...
0.41	0.42	0.35	0.38	0.12	0.20	0.26	0.30	0.29	0.22	0.38	0.39	0.39	0.41	1.00	0.49	0.24	0.25;...
0.42	0.43	0.35	0.38	0.12	0.20	0.26	0.30	0.30	0.22	0.38	0.40	0.39	0.41	0.49	1.00	0.24	0.25;...
0.31	0.32	0.25	0.24	0.02	0.09	0.08	0.25	0.24	0.14	0.23	0.26	0.26	0.30	0.24	0.24	1.00	0.21;...
0.31	0.32	0.25	0.25	0.03	0.10	0.07	0.25	0.25	0.15	0.24	0.27	0.27	0.31	0.25	0.25	0.21	1.00;...
];

%sigma is the CAISO risk vector derived from first stages (from
%Tech_Risk_PJM_CAISO.xlsx
Sigma = [0.065198843; 0.057412585;0.071802991;0.057859418;0.138441046;...
    0.12201202;0.07579699;0.085478896;0.08409905;0.031337238;0.080286856;...
    0.10017006;0.098763559;0.050301672;0.06999326;0.07083148;0.049281566;...
    0.045612461];

%cost is the CAISO levelized cost per MWh derived from 2019 ATB
cost = [9.48; 95.9; 56.6; 44.03; 16.1; 34.72; 111.38; 68.87; 79.06; ...
110.18; 96.12; 89.25; 147.21; 55.41; 73.53; 107.23; 55.84; 67.36];


z = zeros(2,1); % output of objective function is a vector with two entries
A = (transpose(x)* x).*Rho.*(Sigma*transpose(Sigma));
A1 = sum(A, 'all');
z(1) = sqrt(A1);
z(2) = x * cost;