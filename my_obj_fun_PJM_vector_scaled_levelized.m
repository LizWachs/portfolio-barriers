function z = my_obj_fun_PJM_vector_scaled_levelized(x)   %x is an nx1 vector of weights
%rho is the PJM correlation matrix derived from first stages of model
%in this function it is the correlation matrix derived by V * C * V^T
% x will be a row vector of size specified in main function call 
Rho = [1.00	0.44	0.37	0.39	0.15	0.22	0.32	0.35	0.34	0.22	0.38	0.41	0.41	0.43	0.39	0.39	0.32	0.32;...
0.44	1.00	0.37	0.39	0.15	0.22	0.32	0.35	0.34	0.22	0.38	0.41	0.41	0.43	0.39	0.39	0.32	0.32;...
0.37	0.37	1.00	0.32	0.10	0.17	0.11	0.31	0.31	0.19	0.33	0.35	0.35	0.38	0.34	0.34	0.29	0.29;...
0.39	0.39	0.34	1.00	0.13	0.20	0.28	0.31	0.31	0.21	0.38	0.38	0.38	0.39	0.38	0.38	0.28	0.29;...
0.15	0.15	0.10	0.13	1.00	0.34	0.18	0.08	0.08	0.07	0.13	0.14	0.14	0.16	0.13	0.13	0.06	0.07;...
0.22	0.22	0.17	0.20	0.34	1.00	0.16	0.17	0.17	0.11	0.20	0.21	0.21	0.24	0.20	0.20	0.13	0.14;...
0.32	0.32	0.11	0.28	0.18	0.16	1.00	0.07	0.06	0.16	0.28	0.30	0.30	0.14	0.28	0.29	0.07	0.06;...
0.35	0.35	0.31	0.31	0.08	0.17	0.07	1.00	0.36	0.18	0.31	0.33	0.33	0.37	0.31	0.31	0.32	0.33;...
0.34	0.34	0.31	0.31	0.08	0.17	0.06	0.36	1.00	0.17	0.30	0.32	0.32	0.36	0.31	0.31	0.32	0.32;...
0.22	0.22	0.19	0.21	0.07	0.11	0.16	0.18	0.17	1.00	0.21	0.22	0.22	0.22	0.21	0.21	0.16	0.17;...
0.38	0.38	0.33	0.38	0.13	0.20	0.28	0.31	0.30	0.21	1.00	0.50	0.50	0.38	0.37	0.37	0.27	0.28;...
0.41	0.41	0.35	0.38	0.14	0.21	0.30	0.33	0.32	0.22	0.50	1.00	0.50	0.41	0.38	0.38	0.30	0.31;...
0.41	0.41	0.35	0.38	0.14	0.21	0.30	0.33	0.32	0.22	0.50	0.50	1.00	0.41	0.38	0.38	0.30	0.30;...
0.43	0.43	0.38	0.39	0.16	0.24	0.14	0.37	0.36	0.22	0.38	0.41	0.41	1.00	0.39	0.39	0.34	0.34;...
0.39	0.39	0.34	0.38	0.13	0.20	0.28	0.31	0.31	0.21	0.37	0.38	0.38	0.39	1.00	0.51	0.28	0.29;...
0.39	0.39	0.34	0.38	0.13	0.20	0.29	0.31	0.31	0.21	0.37	0.38	0.38	0.39	0.51	1.00	0.28	0.29;...
0.32	0.32	0.29	0.28	0.06	0.13	0.07	0.32	0.32	0.16	0.27	0.30	0.30	0.34	0.28	0.28	1.00	0.31;...
0.32	0.32	0.29	0.29	0.07	0.14	0.06	0.33	0.32	0.17	0.28	0.31	0.30	0.34	0.29	0.29	0.31	1.00];

%sigma is the PJM risk vector derived from first stages
Sigma = [0.053722454; 0.046934007; 0.066378142;...
0.054807656; 0.153972951; 0.123309476; 0.066498663;...
0.083668671; 0.082269048; 0.034014131; 0.075064424;...
0.091212515; 0.090052339; 0.046403454; 0.066070012;...
0.066636064; 0.058528476; 0.053554792]; 

%cost is the PJM total cost per kWh from the ATB
cost = [44.58; 97.7; 66.99; 20.74; 37.69; 60.1; 145.74;... 
93.17; 107.7; 111.9; 113.95; 108.24; 189.68; 52.52;... 
76.3; 111.25; 77.66; 89.33];


z = zeros(2,1); % output of objective function is a vector with two entries
A = (transpose(x)* x).*Rho.*(Sigma*transpose(Sigma));
A1 = sum(A, 'all');
z(1) = sqrt(A1);
z(2) = x * cost;